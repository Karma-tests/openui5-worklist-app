/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/model/json/JSONModel","sap/f/cards/Data","sap/base/Log"],function(t,e,a,i){"use strict";var n=t.extend("sap.f.cards.BaseContent",{metadata:{properties:{configuration:{type:"object"}},aggregations:{_content:{multiple:false,visibility:"hidden"}}},constructor:function(e,a){if(typeof e!=="string"){a=e}if(a&&a.serviceManager){this._oServiceManager=a.serviceManager;delete a.serviceManager}t.apply(this,arguments)},renderer:function(t,e){var a="sapFCard";var i=e.getMetadata().getLibraryName();var n=e.getMetadata().getName();a+=n.slice(i.length+1,n.length);t.write("<div");t.writeElementData(e);t.addClass(a);t.writeClasses();t.write(">");t.renderControl(e.getAggregation("_content"));t.write("</div>")}});n.prototype.init=function(){var t=new e;this.setModel(t)};n.prototype.destroy=function(){this.setAggregation("_content",null);this.setModel(null);if(this._dataChangeHandler&&this._oDataService){this._oDataService.detachDataChanged(this._dataChangeHandler);this._dataChangeHandler=null;this._oDataService=null}return t.prototype.destroy.apply(this,arguments)};n.prototype.setConfiguration=function(t){this.setProperty("configuration",t);if(!t){return this}if(t.data){this._setData(t.data)}return this};n.prototype._setData=function(t){var e=t.request;var n=t.service;this.bindElement({path:t.path||"/"});if(t.json&&!e){this._updateModel(t.json)}if(n){this._oServiceManager.getService("sap.ui.integration.services.Data").then(function(e){if(e){this._dataChangeHandler=function(t){this._updateModel(t.data)}.bind(this);e.getData().then(function(t){this._updateModel(t)}.bind(this)).catch(function(){i.error("Card content data service failed to get data")});e.attachDataChanged(this._dataChangeHandler,t.service.parameters);this._oDataService=e}}.bind(this)).catch(function(){i.error("Data service unavailable")})}else if(e){a.fetch(e).then(function(e){this._updateModel(e,t.path)}.bind(this)).catch(function(t){i.error("Card content data request failed")})}};n.prototype._updateModel=function(t){this.getModel().setData(t);setTimeout(function(){this.fireEvent("_updated")}.bind(this),0)};return n});