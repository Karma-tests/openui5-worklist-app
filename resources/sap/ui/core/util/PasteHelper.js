/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/ObjectPath"],function(e){"use strict";var r={};r.getPastedDataAs2DArray=function(e){var r=e.clipboardData;if(!r){r=window.clipboardData}var a=/sapui5Placeholder4MultiLine/g;var t=a.source;var n=/""/g;var i,l,o,s=[];if(r){i=r.getData("Text");var p=[];var f=false;var u=i.indexOf('"'),c=-1;var h,v;while(u>-1){v=i.charAt(u-1);if(u===0||v==="\n"||v==="\t"||v==="\r"){c=i.indexOf('"',u+1);if(c>-1){h=i.charAt(c+1);while(c>-1&&h==='"'){c=i.indexOf('"',c+2);h=i.charAt(c+1)}if(h==="\n"||h==="\t"||h===""||h==="\r"){var g=i.substring(u+1,c);i=i.replace('"'+g+'"',t);g=g.replace(n,'"');p.push(g);u=i.indexOf('"',u+t.length+1);f=true}}}if(!f){u=i.indexOf('"',u+1)}f=false}l=i.split(/\r\n|\r|\n/);var d=0;var y=function(){return p[d++]};for(var w=0;w<l.length;w++){o=l[w];if(p.length>0){o=o.replace(a,y)}if(o.length||w<l.length-1){s.push(o.split("\t"))}}}return s};r.validate=function(a,t){var n={parsedData:null,errors:null};if(!a){throw new Error("Parameter aData is not specified")}if(t){for(var i=0;i<t.length;i++){var l=t[i];if(t.ignore){continue}if(l.property){if(l.type){var o=e.get(l.type);if(o){l.typeInstance=new o}else{throw new Error("Data type "+l.type+" is not available")}}else{throw new Error("Missing ColumnInfo.type for column "+(i+1)+". Check the application calling PasteHelper.validate(aData, aColumnInfo) and specify the missing type in the parameter aColumnInfo.")}}else{throw new Error("Missing ColumnInfo.property for column "+(i+1)+". Check the application calling PasteHelper.validate(aData, aColumnInfo) and specify the missing property in the parameter aColumnInfo.")}}}else{throw new Error("Missing parameter aColumnInfo")}var s=[],p=[];for(var i=0;i<a.length;i++){var f=a[i];var u=r._validateRow(f,t,i,s);p.push(u)}if(s.length>0){n.parsedData=null;n.errors=s}else{n.parsedData=p;n.errors=null}return n};r._validateRow=function(e,r,a,t){var n=sap.ui.getCore().getLibraryResourceBundle(),i={},l={};for(var o=0;o<e.length;o++){var s=r[o];if(r.ignore){continue}var p=e[o];try{if(s.typeInstance){p=s.typeInstance.parseValue(p,"string")}}catch(e){var l={row:a+1,column:o+1,property:s.property,value:p,type:s.type,message:n.getText("PasteHelper.ErrorMessage",[p,a+1,o+1,s.type])};t.push(l);p=null}i[s.property]=p}return i};return r});